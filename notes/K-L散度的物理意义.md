这里我们来讨论一下[[相对熵]]的物理意义

## 相对熵作为熵改变量的平均

为什么我们要定义

$$
D(P||P^*)=\sum_i p_i\ln\left(\frac{p_i}{p_i^*}\right)
$$

这个得拆开成两部分，$\ln\frac{p_i}{p_i^*}$ 是能级$i$在当前状态和参考状态之间的熵的差值。然后我们需要在当前状态求熵的平均，于是有了

$$
D(P||P^*)=\sum p_i\Delta S_i
$$

## 作为自由能的相对熵
当我们想研究两个概率分布的区别有多大的时候，我们会引入一个叫做相对熵的概念。相对熵又被成为Kullback–Leibler(KL)散度或者$KL$距离，定义为

$$
D(P||P^*)=\sum_ip_i\ln\left(\frac{p_i}{p^*_i}\right)
$$

相对熵一定程度是刻画了一个概率分布$P$到参考概率分布$P^*$的距离。我们更关心的是，这个距离的物理意义是什么呢？首先我们可以把相对熵拆成两部分

$$
D(P||P^*)=\underbrace{\sum_ip_i\ln{p_i}}_{-S(P)}-\sum_ip_i\ln{p_i^*}
$$

这里的第一部分是概率分布$P$的熵，而第二部分取决于我们选择了什么态作为参考态。如果用热力学平衡态为参考态，然后去考察任意概率分布距离平衡态有多远，或许就会得到一些有趣的结果。

一个热力学平衡态是由玻尔兹曼分布表示的，$p_i^* =e^{-E_i/k_BT}/Z^*$。考虑到我们之后都讨论平衡态，之后直接用 ‘$eq$’ 这个上标来表示这个参考态。代入之前我们从相对熵重拆解出来的第二项中

$$
\begin{aligned}
\sum_{i}p_i\ln{p_i^{*}}
&=-\sum_{i}p_i\frac{E_i}{k_BT}+\sum_{i}p_i\ln{Z^{eq}}\\
&=-\frac{1}{k_BT}\left(\langle E\rangle_P-F^{eq}\right)\\
&=-\frac{1}{k_BT}\left(\langle E\rangle_P-\langle E\rangle_{eq}+k_BTS(P^{eq})\right)
\end{aligned}
$$

可以看到这一项其实是有分布$P$下系统的平均能量，以及作为参考的平衡态的自由能组成的。我们再看一眼一开始的KL散度，其第一项正好是概率分布$P$的熵。那么把这个“物理化”后的第二项放回去就很美妙了

$$
k_BTD(P||P^{eq})=\underbrace{\langle E\rangle_P-k_BTS(P)}_{\mathcal{F}(P)}-F^{eq}
$$

这里我们用到了[[广义自由能]]的概念，$\mathcal{F}(P)$。这个广义自由能还是很符合直觉，系统的平均能量减去系统的熵。之所以是广义，因为自由能这个概念是定义在平衡态下的，而广义自由能能帮助我们讨论非平衡态下的一般情况。回到KL散度的物理意义，其度量了从热力学平衡态到任意的概率分布$P$后，系统的广义自由能的改变

$$
\boxed{k_BTD(P||P^{eq})=\Delta \mathcal{F}}
$$

有了这个广义自由能的帮助，我们能更好的理解非平衡热力学和[[信息和热力学]]的关系